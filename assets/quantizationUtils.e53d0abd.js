import{bC as n,bD as t,b8 as s,bE as e,bF as r,bG as i,bH as o,bI as a,aS as u,aW as l,aV as c,aT as m,aU as h}from"./vendor.982f672a.js";import{t as f}from"./json.df9e51f4.js";const p=[0,0];function x(n,t){if(!t)return null;if("x"in t){const s={x:0,y:0};return[s.x,s.y]=n(t.x,t.y,p),null!=t.z&&(s.z=t.z),null!=t.m&&(s.m=t.m),s}if("xmin"in t){const s={xmin:0,ymin:0,xmax:0,ymax:0};return[s.xmin,s.ymin]=n(t.xmin,t.ymin,p),[s.xmax,s.ymax]=n(t.xmax,t.ymax,p),t.hasZ&&(s.zmin=t.zmin,s.zmax=t.zmax,s.hasZ=!0),t.hasM&&(s.mmin=t.mmin,s.mmax=t.mmax,s.hasM=!0),s}return"rings"in t?{rings:g(t.rings,n),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:g(t.paths,n),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:y(t.points,n),hasM:t.hasM,hasZ:t.hasZ}:void 0}function g(n,t){const s=[];for(const e of n)s.push(y(e,t));return s}function y(n,t){const s=[];for(const e of n){const n=t(e[0],e[1],[0,0]);s.push(n),e.length>2&&n.push(e[2]),e.length>3&&n.push(e[3])}return s}async function b(n,t){if(!t)return;const s=Array.isArray(n)?n.map((n=>{var t;return null==(t=n.geometry)?void 0:t.spatialReference})):[n];await a(s.map((n=>({source:n,dest:t}))))}const z=x.bind(null,n),_=x.bind(null,t);function d(n,t,a){return n?(a||(a=t,t=n.spatialReference),s(t)&&s(a)&&!e(t,a)?r(t,a)?i(a)?z(n):_(n):o(f,[n],t,a,null)[0]:n):n}const M=new class{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(n,t,s){if(!n||!n.length||!t||!s||e(t,s))return n;const r={geometries:n,inSpatialReference:t,outSpatialReference:s,resolve:null};return this._jobs.push(r),new Promise((n=>{r.resolve=n,null===this._timer&&(this._timer=setTimeout(this._process,10))}))}_process(){this._timer=null;const n=this._jobs.shift();if(!n)return;const{geometries:t,inSpatialReference:s,outSpatialReference:e,resolve:a}=n;r(s,e)?i(e)?a(t.map(z)):a(t.map(_)):a(o(f,t,s,e,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}};function v(n,t,s){return M.push(n,t,s)}const Z=(n,t,s)=>[t,s],j=(n,t,s)=>[t,s,n[2]],w=(n,t,s)=>[t,s,n[2],n[3]];function R(n){return n?{originPosition:"upper-left"===n.originPosition?"upperLeft":"lower-left"===n.originPosition?"lowerLeft":n.originPosition,scale:n.tolerance?[n.tolerance,n.tolerance]:[1,1],translate:n.extent?[n.extent.xmin,n.extent.ymax]:[0,0]}:null}function P({scale:n,translate:t},s){return Math.round((s-t[0])/n[0])}function S({scale:n,translate:t},s){return Math.round((t[1]-s)/n[1])}function A(n,t,s){const e=[];let r,i,o,a;for(let u=0;u<s.length;u++){const l=s[u];u>0?(o=P(n,l[0]),a=S(n,l[1]),o===r&&a===i||(e.push(t(l,o-r,a-i)),r=o,i=a)):(r=P(n,l[0]),i=S(n,l[1]),e.push(t(l,r,i)))}return e.length>0?e:null}function T({scale:n,translate:t},s){return s*n[0]+t[0]}function L({scale:n,translate:t},s){return t[1]-s*n[1]}function C(n,t,s){const e=new Array(s.length);if(!s.length)return e;const[r,i]=n.scale;let o=T(n,s[0][0]),a=L(n,s[0][1]);e[0]=t(s[0],o,a);for(let u=1;u<s.length;u++){const n=s[u];o+=n[0]*r,a-=n[1]*i,e[u]=t(n,o,a)}return e}function D(n,t,s){const e=new Array(s.length);for(let r=0;r<s.length;r++)e[r]=C(n,t,s[r]);return e}function E(n,t,s,e,r){return t.points=function(n,t,s,e){return A(n,s?e?w:j:e?j:Z,t)}(n,s.points,e,r),t}function F(n,t,s,e,r){return t.x=P(n,s.x),t.y=S(n,s.y),t!==s&&(e&&(t.z=s.z),r&&(t.m=s.m)),t}function G(n,t,s,e,r){const i=function(n,t,s,e){const r=[],i=s?e?w:j:e?j:Z;for(let o=0;o<t.length;o++){const s=A(n,i,t[o]);s&&s.length>=3&&r.push(s)}return r.length?r:null}(n,s.rings,e,r);return i?(t.rings=i,t):null}function H(n,t,s,e,r){const i=function(n,t,s,e){const r=[],i=s?e?w:j:e?j:Z;for(let o=0;o<t.length;o++){const s=A(n,i,t[o]);s&&s.length>=2&&r.push(s)}return r.length?r:null}(n,s.paths,e,r);return i?(t.paths=i,t):null}function I(n,t){return n&&t?u(t)?F(n,{},t,!1,!1):l(t)?H(n,{},t,!1,!1):c(t)?G(n,{},t,!1,!1):m(t)?E(n,{},t,!1,!1):h(t)?(i=!1,o=!1,(e={}).xmin=P(s=n,(r=t).xmin),e.ymin=S(s,r.ymin),e.xmax=P(s,r.xmax),e.ymax=S(s,r.ymax),e!==r&&(i&&(e.zmin=r.zmin,e.zmax=r.zmax),o&&(e.mmin=r.mmin,e.mmax=r.mmax)),e):null:null;var s,e,r,i,o}function U(n,t,s,e,r){return t.points=function(n,t,s,e){return C(n,s?e?w:j:e?j:Z,t)}(n,s.points,e,r),t}function V(n,t,s,e,r){return t.x=T(n,s.x),t.y=L(n,s.y),t!==s&&(e&&(t.z=s.z),r&&(t.m=s.m)),t}function W(n,t,s,e,r){return t.rings=function(n,t,s,e){return D(n,s?e?w:j:e?j:Z,t)}(n,s.rings,e,r),t}function k(n,t,s,e,r){return t.paths=function(n,t,s,e){return D(n,s?e?w:j:e?j:Z,t)}(n,s.paths,e,r),t}export{F as L,U,I as d,v as j,V as k,R as m,b as p,W as q,k as v,d as y};
